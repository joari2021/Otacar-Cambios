<%render "partials/name-and-cod-of-banks"%>
<%= form_with(model: transaction, local: true, :html => { :class => "mb-5", :id => "form"}) do |form| %>
<% if transaction.errors.any? %>
<div id="error_explanation">
    <h2><%= pluralize(transaction.errors.count, "error") %> prohibited this transaction from being saved:</h2>

    <ul>
        <% transaction.errors.full_messages.each do |message| %>
        <li><%= message %></li>
        <% end %>
    </ul>
</div>
<% end %>
<%
    #BANCOS ESTANDARES
    bank_argentina = 0
    bank_brubank = 0
    bank_galicia = 0
    
    bank_colombia = 0

    bank_chile = 0

    bank_ecuador = 0

    bank_españa = 0

    bank_panama = 0
    bank_bankia = 0
    bank_santander_pan = 0

    bank_peru = 0
    bank_bcp = 0
    bank_escotia_bank = 0

    bank_venezuela = 0
    bank_bod = 0
    bank_mercantil = 0
    bank_vzla = 0
    bank_banesco = 0

    accounts_admin_from_country_user = 0

    if admin.banks.count > 0
        admin.banks.where(view:true).each do |bank|
            #BANCOS DEL PAIS DESTINO DEL USUARIO
            case bank.country
            when "Argentina"
                if bank.status === "activo"
                    bank_argentina += 1
                    if bank.banco === "Brubank"
                        bank_brubank += 1
                    elsif bank.banco === "Galicia"
                        bank_galicia += 1
                    end
                end
            when "Colombia"
                if bank.status === "activo"
                    bank_colombia += 1
                end
            when "Chile"
                if bank.status === "activo"
                    bank_chile += 1
                end 
            when "Ecuador"
                if bank.status === "activo"
                    bank_ecuador += 1
                end  
            when "España"
                if bank.status === "activo"
                    bank_españa += 1
                    if bank.banco === "Bankia"
                        bank_bankia += 1
                    elsif bank.banco === "Santander"
                        bank_santander_pan += 1
                    end
                end
            when "Panama"
                if bank.status === "activo"
                    bank_panama += 1
                end 
            when "Peru"
                if bank.status === "activo"
                    bank_peru += 1
                    if bank.banco === "Banco BCP"
                        bank_bcp += 1
                    elsif bank.banco === "Scotiabank"
                        bank_escotia_bank += 1
                    end
                end
            when "Venezuela"
                if bank.status === "activo"
                    bank_venezuela += 1
                    if bank.banco === "B.O.D"
                        bank_bod += 1
                    elsif bank.banco === "Banco Mercantil"
                        bank_mercantil += 1
                    elsif bank.banco === "Banco De Venezuela"
                        bank_vzla += 1
                    elsif bank.banco === "Banco Banesco"
                        bank_banesco += 1
                    end
                end                      
            end
            
            #BANCOS DEL PAIS ORIGEN DEL USUARIO
            if bank.country === current_user.country
                if bank.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    #BANCOS, MONEDEROS Y PAGO MOVIL DE BRASIL
    bank_brasil = 0
    bank_do_brasil = 0
    bank_bradesco = 0
    bank_caixa = 0
    bank_nubank = 0
    bank_itau = 0
    bank_iti = 0
    bank_santander = 0
    if admin.bank_brasils.count > 0
        admin.bank_brasils.where(view:true).each do |bank|
            if bank.status === "activo" 
                bank_brasil += 1
                if bank.bank === "Banco Do Brasil"
                    bank_do_brasil += 1
                elsif bank.bank === "Bradesco"
                    bank_bradesco += 1
                elsif bank.bank === "Caixa"
                    bank_caixa += 1
                elsif bank.bank === "Itaú"
                    bank_itau += 1
                elsif bank.bank === "Iti"
                    bank_iti += 1
                elsif bank.bank === "Nubank"
                    bank_nubank += 1
                elsif bank.bank === "Santander"
                    bank_santander += 1
                end
            end
            
            if bank.country === current_user.country
                if bank.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    wallet_brasil = 0
    wallet_usa = 0
    if admin.wallets.count > 0
        admin.wallets.where(view:true).each do |wallet|
            if wallet.wallet_name === "Pix"
                if wallet.status === "activo"
                    wallet_brasil += 1
                end

                if wallet.country === current_user.country
                    if wallet.status === "activo"
                        accounts_admin_from_country_user += 1
                    end  
                end
            end
            if wallet.wallet_name === "Zelle" 
                if wallet.status === "activo"
                    wallet_usa += 1
                end

                if wallet.country === current_user.country
                    if wallet.status === "activo"
                        accounts_admin_from_country_user += 1
                    end  
                end
            end
        end
    end

    wallet_with_user_brasil = 0
    if admin.wallet_with_users.count > 0
        admin.wallet_with_users.where(view:true).each do |wallet|
            if wallet.status === "activo"
                wallet_with_user_brasil += 1
            end

            if wallet.country === current_user.country
                if wallet.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    digital_payments = 0
    if admin.digital_payments.count > 0
        admin.digital_payments.where(view:true).each do |payment|
            if payment.status === "activo"
                digital_payments += 1
            end

            if payment.country === current_user.country
                if payment.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    mobile_payments = 0
    if admin.mobile_payments.count > 0
        admin.mobile_payments.where(view:true).each do |payment|
            if payment.status === "activo"
                mobile_payments += 1
            end

            if payment.country === current_user.country
                if payment.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    #CUENTAS DEL ADMIN EN BRASIL
    accounts_brasil = bank_brasil + wallet_brasil + wallet_with_user_brasil

    #CUENTAS DEL ADMIN EN COLOMBIA
    accounts_colombia = bank_colombia + digital_payments

    #CUENTAS DEL ADMIN EN VENEZUELA
    accounts_venezuela = bank_venezuela + mobile_payments
%>  

<%paises = {"Argentina" => false, "Brasil" => false, "Chile" => false, "Colombia" => false, "Ecuador" => false, "España" => false, "Panama" => false, "Peru" => false, "Usa" => false, "Venezuela" => false}%>

<%if current_user.country != "Argentina" && rate.rate_argentina != "0,00" && bank_argentina > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Argentina"] = true%>
<%end%>

<%if current_user.country != "Brasil" && rate.rate_brasil != "0,00" && accounts_brasil > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Brasil"] = true%>
<%end%>

<%if current_user.country != "Chile" && rate.rate_chile != "0,00" && bank_chile > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Chile"] = true%>
<%end%>

<%if current_user.country != "Colombia" && rate.rate_colombia != "0,00" && accounts_colombia > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Colombia"] = true%>
<%end%>

<%if current_user.country != "Ecuador" && rate.rate_ecuador != "0,00" && bank_ecuador > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Ecuador"] = true%>
<%end%>

<%if current_user.country != "España" && rate.rate_españa != "0,00" && bank_españa > 0 && accounts_admin_from_country_user > 0%>
    <%paises["España"] = true%>
<%end%>

<%if current_user.country != "Panama" && rate.rate_panama != "0,00" && bank_panama > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Panama"] = true%>
<%end%>

<%if current_user.country != "Peru" && rate.rate_peru != "0,00" && bank_peru > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Peru"] = true%>
<%end%>

<%if current_user.country != "USA" && rate.rate_usa != "0,00" && wallet_usa > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Usa"] = true%>
<%end%>

<%if current_user.country != "Venezuela" && rate.rate_venezuela != "0,00" && accounts_venezuela > 0 && accounts_admin_from_country_user > 0%>
    <%paises["Venezuela"] = true%>
<%end%>

<!--PAIS DESTINO-->
<div class="row justify-content-center mt-5">
    <div class="col-12 col-sm-9 col-lg-7">
        <h5 class="text-primary text-center">1.- Pais Destino <i class="fas fa-info-circle" onclick="mostrarInfo('infoPaisDestino')"></i></h5>    
        <div class="alert alert-info d-none" id="infoPaisDestino" role="alert">
                Elige el pais donde deseas enviar tus remesas.
        </div>
        
        <div class="contenedor">   
            <div class="selectbox">
                <div class="select" id="selectPaisDestino">
                    <div class="contenido-select">
                        <h2 class="titulo">Elige un pais</h2>
                    </div>
                    <i class="fas fa-angle-down"></i>
                </div>

                <div class="opciones" id="opcionesPaisDestino">
                    <%paises.each do |llave, valor|%>
                        <%if valor === true%>
                            <a href="#" class="opcion">
                                <div class="contenido-opcion">
                                    <img src="/img/paises/<%=llave%>.svg" alt="">
                                    <div class="textos">
                                        <h2 class="titulo tam-h2"><%=llave%></h2>
                                    </div>
                                </div>
                            </a>
                        <%else%>
                            <span class="">
                                <div class="contenido-opcion-disabled">
                                    <img src="/img/paises/<%=llave%>.svg" alt="">
                                    <div class="textos tam-div">
                                        <h2 class="titulo"><%=llave%></h2>
                                        <p class="descripcion">No Disponible</p>
                                    </div>
                                </div>
                            </span>
                        <%end%>
                    <%end%> 
                </div>
            </div>

            <input type="hidden" name="transaction[country_destinity]" id="inputPais" value="">
        </div>
    </div>
</div>

<!--METODOS DE PAGO DISPONIBLES PARA RECIBIR ENVIOS-->
<div class="row justify-content-center mt-2 d-none" id="listaMetodos">
    <div class="col-12 col-sm-9 col-lg-7">
        <div class="alert alert-warning text-center" role="alert">
            Metodos de pago disponibles en <span id="countryDest" class="font-weight-bold"></span> para recibir envio de remesas.<br>
            <article id="metodosDisp" class="font-weight-bold"></article>
        </div>
    </div>
</div>

<div class="modal fade" id="list-methods" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content text-center">
      <div class="modal-header m-auto">
        <h5 class="modal-title" id="staticBackdropLabel">Otros Bancos</h5>
      </div>
      <div class="modal-body alert-warning">
        <%@avalaible_banks.each do |bank|%>
            <%=@bancos[bank.bank]%><br>
        <%end%>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
<!--FIN DE METODOS DE PAGOS DISPONIBLES PARA RECIBIR DINERO-->

<div class="row justify-content-center mt-2 d-none" id="añadirAccount">
    <div class="col-12 col-sm-9 col-lg-7">
        <div class="alert alert-danger text-center" role="alert">
            No tienes un metodo de pago registrado en <span id="country" class="font-weight-bold"></span> para recibir el envio de tus remesas.<br><a href="/set_method" class="special-link alert-link" style="text-decoration:none">Haz click aquí</a> para añadir un metodo de pago.
        </div>
    </div>
</div>

<!--CUENTA DESTINO DEL USUARIO-->
<div class="row justify-content-center d-none" id="accountUserDestinity">
    <div class="col-12 col-sm-9 col-lg-7">
        <h5 class="text-primary text-center">2.- Cuenta Credito <i class="fas fa-info-circle" onclick="mostrarInfo('infoCuentaDestino')"></i></h5>    
        <div class="alert alert-info" id="infoCuentaDestino" role="alert">
            Elige la cuenta de <span id="spanPaisDestino"></span> donde deseas que sea acreditado el envio de tus remesas. En esta lista solo apareceran los metodos de pago que hayas registrado y a los que la empresa puede hacer envios en ese pais los cuales se muestran arriba.
            
            <article id="info-comision-pago-movil"><br>Si el pago móvil es para el Banco De Venezuela, Mercantil, Banesco y/o B.O.D se le debitara el 0.3% de comisión bancaria.</article>
        </div>
        <div class="contenedor">     
            <div class="selectbox">
                <div class="select" id="selectAccountUserDestino" onclick="activarFuncionSelectBoxAccountDestinityUser(this,1)">
                    <div class="contenido-select text-center" id="contenidoSelectAccountUserDestinity">
                        <h2 class="titulo" id='tituloAccountUserDestino'>Cuenta Nro. 1</h2>
                    </div>
                    <i class="fas fa-angle-down"></i>
                </div>

                <div class="opciones" id="opcionesAccountUserDestino1"></div>
            </div>
            <input type="hidden" name="transaction[account_destinity_usuario]" id="inputAccountUserDestino" value="">    
        </div>
        
        <div class="contenedor d-none" id="contenedorAccountUser2">     
            <div class="selectbox">
                <div class="select" id="selectAccountUserDestino2" onclick="activarFuncionSelectBoxAccountDestinityUser(this,2)">
                    <div class="contenido-select text-center" id="contenidoSelectAccountUserDestinity2">
                        <h2 class="titulo" id='tituloAccountUserDestino'>Cuenta Nro. 2</h2>
                    </div>
                    <i class="fas fa-angle-down"></i>
                </div>

                <div class="opciones" id="opcionesAccountUserDestino2"></div>
            </div>
            <input type="hidden" id="inputAccountUserDestino2" value="">    
        </div>

        <div class="contenedor d-none" id="contenedorAccountUser3">     
            <div class="selectbox">
                <div class="select" id="selectAccountUserDestino3" onclick="activarFuncionSelectBoxAccountDestinityUser(this,3)">
                    <div class="contenido-select text-center" id="contenidoSelectAccountUserDestinity3">
                        <h2 class="titulo" id='tituloAccountUserDestino'>Cuenta Nro. 3</h2>
                    </div>
                    <i class="fas fa-angle-down"></i>
                </div>

                <div class="opciones" id="opcionesAccountUserDestino3"></div>
            </div>
            <input type="hidden" id="inputAccountUserDestino3" value="">    
        </div>
        <div class="text-center mb-4" style="margin-top:-25px;">
            <a class="btn btn-info d-none" href="#" id="btn-añadir-account" onclick="añadirCuentasUser(event)"><i class="fas fa-plus"></i></a>
            <a class="btn btn-danger ml-2 d-none" href="#" id="btn-eliminar-account" onclick="eliminarCuentasUser(event)"><i class="fas fa-trash-alt"></i></a>
        </div>
    </div>
</div>

<!--CUENTA DESTINO DEL ADMIN-->
<div class="row justify-content-center d-none" id="accountAdminDestinity">
    <div class="col-12 col-sm-9 col-lg-7">
        <h5 class="text-primary text-center">3.- Cuentas De Otacar Cambios <i class="fas fa-info-circle" onclick="mostrarInfo('infoCuentaDestinoAdmin')"></i></h5>    
        <div class="alert alert-info d-none" id="infoCuentaDestinoAdmin" role="alert">
            Elige una cuenta de las disponibles de Otacar Cambios en <span class="font-weight-bold"><%=current_user.country%></span> donde deseas realizar el pago en tu moneda local (<span class="font-weight-bold"><%=rate.moneda%></span>).
        </div>
        <div class="contenedor">     
            <div class="selectbox">
                <div class="select" id="selectAccountAdminDestino">
                    <div class="contenido-select text-center" id="contenidoSelectAccountAdminDestinity">
                        <h2 class="titulo" id='tituloAccountAdminDestino'>Elige una opcion</h2>
                    </div>
                    <i class="fas fa-angle-down"></i>
                </div>

                <div class="opciones" id="opcionesAccountAdminDestino"></div>
            </div>
            <input type="hidden" name="transaction[account_destinity_admin]" id="inputAccountAdminDestino" value="">    
        </div>
    </div>
</div>

<!--FORMA DE PAGO-->
<div class="row justify-content-center d-none" id="metodosPago">
    <div class="col-12 col-sm-9 col-lg-7">
        <h5 class="text-primary text-center">4.- Formas de Pago <i class="fas fa-info-circle" onclick="mostrarInfo('infoMetodosPago')"></i></h5>    
        <div class="alert alert-info d-none" id="infoMetodosPago" role="alert">
            Elige la forma de pago que deseas utilizar para pagar a la cuenta de Otacar Cambios que has elegido.
        </div>
        <div class="contenedor">     
            <div class="selectbox">
                <div class="select" id="selectMetodoPago" onclick="activarFuncionSelectBoxMetodosPago()">
                    <div class="contenido-select text-center" id="contenidoSelectMetodoPago">
                        <h2 class="titulo" id='tituloMetodoPago'>Elige una opcion</h2>
                    </div>
                    <i class="fas fa-angle-down"></i>
                </div>

                <div class="opciones" id="opcionesMetodoPago"></div>
            </div>
            <input type="hidden" name="transaction[metodo]" id="inputMetodoPago" value="">    
        </div>
    </div>
</div>

<!--MONTO ENVIO-->
<div class="row justify-content-center field mt-2 d-none" id="montoEnvio">
    <div class="col-12 col-sm-9 col-lg-7 text-center">
    
        <h5 class="text-primary">5.- Monto De Envio <i class="fas fa-info-circle" onclick="mostrarInfo('infoMontoEnvio')"></i></h5>    
        <div class="alert alert-info d-none" id="infoMontoEnvio" role="alert">
            Ingresa el monto que deseas enviar. Puedes observar la tasa de envio hacia el pais al que deseas enviar tus remesas y el monto minimo permitido para hacer envios de <span class="font-weight-bold"><%=current_user.country%></span> a ese pais.
        </div>
        <div class="card border-primary m-auto">
            <div class="card-header text-center">Tasa</div>
            <div class="card-body text-primary">
                <td class="align-middle"><img src="/img/paises/<%=current_user.country.capitalize%>.svg" class="img-fluid rounded-circle avatarBig" alt="<%=current_user.country.capitalize%>" title="<%=current_user.country%>"/></td>
                <span class="align-middle mx-2 text-warning" style="font-size:25px"><i class="far fa-arrow-alt-circle-right"></i></span>
                <td class="align-middle"><img src="" class="img-fluid rounded-circle avatarBig" alt="" title="" id="paisDestino"/></td>
                <p class="card-text mt-1">
                    <%=rate.moneda%> x 1<br>
                    <span id="tasa" class="text-warning"></span> 
                    <span id="tasaOf"></span>
                    <span id="tasaOf2" class="text-warning"></span>
                </p>
            </div>
        </div> 
        <input class="form-control is-invalid text-center mt-3" id="validationMonto" type="text" name="transaction[monto_envio]">
        <div class="invalid-feedback">
          Ingrese el monto que deseas enviar en <%=rate.moneda%>.<br>
          Monto Minimo: <span id="montoMin"></span>
        </div>

        <div class="actions mb-5 mt-4 d-none" id="btnEnviarDinero">
            
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-info" data-toggle="modal" data-target="#staticBackdrop" onclick="detail_transaction()">
            Continuar
            </button>

            <!-- Modal  Detalles de la Transaccion-->
            <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-scrollable">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="staticBackdropLabel">Detalles de la transacción</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item">
                                    <span class="float-left font-weight-bold">Pais destino</span><br>
                                    <span class="float-right font-weight-bold text-warning" id="detail-pais-destino"></span></li>
                                <li class="list-group-item">
                                    <span class="float-left font-weight-bold">Cuenta credito</span><br>
                                    <span class="float-right font-weight-bold text-warning text-capitalize" id="detail-cuenta-credito-usuario"></span>
                                    <div class="d-none" id="div-detail-account-usuario2"><br><span class="float-right font-weight-bold text-warning" id="detail-cuenta-credito-usuario2"></span></div>
                                    <div class="d-none" id="div-detail-account-usuario3"><br><span class="float-right font-weight-bold text-warning" id="detail-cuenta-credito-usuario3"></span></div></li>
                                <li class="list-group-item">
                                    <span class="float-left font-weight-bold">Cuenta Otacar Cambios</span><br>
                                    <span class="float-right font-weight-bold text-warning" id="detail-cuenta-otacar"></span></li>
                                <li class="list-group-item">
                                    <span class="float-left font-weight-bold">Forma de pago</span><br>
                                    <span class="float-right font-weight-bold text-warning" id="detail-forma-pago"></span></li>
                                <li class="list-group-item">
                                    <span class="float-left font-weight-bold">Tasa x 1 <%=rate.moneda%></span><br>
                                    <span class="float-right font-weight-bold text-warning" id="detail-tasa"></span></li>
                                <li class="list-group-item">
                                    <span class="float-left font-weight-bold">Monto a pagar</span><br>
                                    <span class="float-right font-weight-bold text-warning" id="detail-monto-envio"></span></li>
                                <li class="list-group-item">
                                    <span class="float-left font-weight-bold">Monto a recibir</span><br>
                                    <span class="float-right font-weight-bold text-warning" id="detail-monto-a-recibir"></span></li>
                                <li class="list-group-item d-none" id="list-comision">
                                    <span class="float-left font-weight-bold">Comisión 0,3% (pago móvil)</span><br>
                                    <span class="float-right font-weight-bold text-warning" id="detail-comision"></span></li>
                                <li class="list-group-item d-none" id="list-comision-2">
                                    <span class="float-left font-weight-bold">Total a recibir</span><br>
                                    <span class="float-right font-weight-bold text-warning" id="detail-monto-total"></span></li>
                            </ul>
                        </div>
                        <div class="modal-footer">
                            <%= form.submit "Continuar", class:"btn btn-info m-auto", onclick:"formatearMonto()"%>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<%end%>

<script src="/js/vistas/script-form-for-campos.js"></script>
<script>
<%
    #BANCOS ESTANDARES
    bank_argentina = 0
    bank_brubank = 0
    bank_galicia = 0
    
    bank_colombia = 0

    bank_chile = 0

    bank_ecuador = 0

    bank_españa = 0

    bank_panama = 0
    bank_bankia = 0
    bank_santander_pan = 0

    bank_peru = 0
    bank_bcp = 0
    bank_escotia_bank = 0

    bank_venezuela = 0
    bank_bod = 0
    bank_mercantil = 0
    bank_vzla = 0
    bank_banesco = 0

    accounts_admin_from_country_user = 0

    if admin.banks.count > 0
        admin.banks.each do |bank|
            #BANCOS DEL PAIS DESTINO DEL USUARIO
            case bank.country
            when "Argentina"
                if bank.status === "activo"
                    bank_argentina += 1
                    if bank.banco === "Brubank"
                        bank_brubank += 1
                    elsif bank.banco === "Galicia"
                        bank_galicia += 1
                    end
                end
            when "Colombia"
                if bank.status === "activo"
                    bank_colombia += 1
                end
            when "Chile"
                if bank.status === "activo"
                    bank_chile += 1
                end 
            when "Ecuador"
                if bank.status === "activo"
                    bank_ecuador += 1
                end  
            when "España"
                if bank.status === "activo"
                    bank_españa += 1
                    if bank.banco === "Bankia"
                        bank_bankia += 1
                    elsif bank.banco === "Santander"
                        bank_santander_pan += 1
                    end
                end
            when "Panama"
                if bank.status === "activo"
                    bank_panama += 1
                end 
            when "Peru"
                if bank.status === "activo"
                    bank_peru += 1
                    if bank.banco === "Banco BCP"
                        bank_bcp += 1
                    elsif bank.banco === "Escotia Bank"
                        bank_escotia_bank += 1
                    end
                end
            when "Venezuela"
                if bank.status === "activo"
                    bank_venezuela += 1
                    if bank.banco === "B.O.D"
                        bank_bod += 1
                    elsif bank.banco === "Banco Mercantil"
                        bank_mercantil += 1
                    elsif bank.banco === "Banco De Venezuela"
                        bank_vzla += 1
                    elsif bank.banco === "Banco Banesco"
                        bank_banesco += 1
                    end
                end                      
            end
            
            #BANCOS DEL PAIS ORIGEN DEL USUARIO
            if bank.country === current_user.country
                if bank.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    #BANCOS, MONEDEROS Y PAGO MOVIL DE BRASIL
    bank_brasil = 0
    bank_do_brasil = 0
    bank_bradesco = 0
    bank_caixa = 0
    bank_itau = 0
    bank_iti = 0
    bank_nubank = 0
    bank_santander = 0
    if admin.bank_brasils.count > 0
        admin.bank_brasils.each do |bank|
            if bank.status === "activo"
                bank_brasil += 1
                if bank.bank === "Banco Do Brasil"
                    bank_do_brasil += 1
                elsif bank.bank === "Bradesco"
                    bank_bradesco += 1
                elsif bank.bank === "Caixa"
                    bank_caixa += 1
                elsif bank.bank === "Itaú"
                    bank_itau += 1
                elsif bank.bank === "Ití"
                    bank_iti += 1
                elsif bank.bank === "Nubank"
                    bank_nubank += 1
                elsif bank.bank === "Santander"
                    bank_santander += 1
                end
            end
            
            if bank.country === current_user.country
                if bank.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    wallet_brasil = 0
    wallet_usa = 0
    if admin.wallets.count > 0
        admin.wallets.each do |wallet|
            if wallet.wallet_name === "Pix"
                if wallet.status === "activo"
                    wallet_brasil += 1
                end

                if wallet.country === current_user.country
                    if wallet.status === "activo"
                        accounts_admin_from_country_user += 1
                    end  
                end
            end
            if wallet.wallet_name === "Zelle"
                if wallet.status === "activo"
                    wallet_usa += 1
                end

                if wallet.country === current_user.country
                    if wallet.status === "activo"
                        accounts_admin_from_country_user += 1
                    end  
                end
            end
        end
    end

    wallet_with_user_brasil = 0
    if admin.wallet_with_users.count > 0
        admin.wallet_with_users.each do |wallet|
            if wallet.status === "activo"
                wallet_with_user_brasil += 1
            end

            if wallet.country === current_user.country
                if wallet.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    digital_payments = 0
    if admin.digital_payments.count > 0
        admin.digital_payments.each do |payment|
            if payment.status === "activo"
                digital_payments += 1
            end

            if payment.country === current_user.country
                if payment.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    mobile_payments = 0
    if admin.mobile_payments.count > 0
        admin.mobile_payments.each do |payment|
            if payment.status === "activo"
                mobile_payments += 1
            end

            if payment.country === current_user.country
                if payment.status === "activo"
                    accounts_admin_from_country_user += 1
                end  
            end
        end
    end

    #CUENTAS DEL ADMIN EN BRASIL
    accounts_brasil = bank_brasil + wallet_brasil + wallet_with_user_brasil

    #CUENTAS DEL ADMIN EN COLOMBIA
    accounts_colombia = bank_colombia + digital_payments

    #CUENTAS DEL ADMIN EN VENEZUELA
    accounts_venezuela = bank_venezuela + mobile_payments
%>  
    //VARIABLES GLOBALES ///////////////////////////////////////////////////////////////////////////////////
    accountUserDestinity = document.getElementById("accountUserDestinity");

    selectPaisDestino = document.querySelector('#selectPaisDestino');
    opcionesPaisDestino = document.querySelector('#opcionesPaisDestino');
    
    selectAccountUserDestino = document.querySelector('#selectAccountUserDestino');
    selectAccountUserDestino2 = document.getElementById("selectAccountUserDestino2")
    selectAccountUserDestino3 = document.getElementById("selectAccountUserDestino3")

    opcionesAccountUserDestino = document.querySelector('#opcionesAccountUserDestino1');
    opcionesAccountUserDestino2 = document.querySelector('#opcionesAccountUserDestino2');
    opcionesAccountUserDestino3 = document.querySelector('#opcionesAccountUserDestino3');
    btn_añadir_account = document.getElementById("btn-añadir-account");
    btn_eliminar_account = document.getElementById("btn-eliminar-account");

    selectAccountAdminDestino = document.querySelector('#selectAccountAdminDestino');
    opcionesAccountAdminDestino = document.querySelector('#opcionesAccountAdminDestino');

    selectMetodoPago = document.querySelector('#selectMetodoPago');
    opcionesMetodoPago = document.querySelector('#opcionesMetodoPago');

    
    function mostrarInfo(id){
        cajaInfo = document.getElementById(id);
        cajaInfo.classList.toggle("d-none");
    }

    function metodosDisp(country){
        listaMetodos = document.getElementById("listaMetodos");
        countryDest = document.getElementById("countryDest");
        article = document.getElementById("metodosDisp");

        countryDest.innerHTML = country;

        optionsSpans = article.childNodes;

        if (optionsSpans.length > 0){
            limit = optionsSpans.length
            for (i=0; i < limit; i++){
                article.removeChild(optionsSpans[0]);   
            }
        }
        function mostrarMetodoDisp(metodo){
            
            var span = document.createElement("span");
            var content = document.createTextNode("* "+metodo);
            var br = document.createElement("br");

            span.appendChild(content);
            article.appendChild(span);
            article.appendChild(br);
        }
        switch (country){
            case "Argentina":
                
                <%if bank_brubank > 0%>
                    mostrarMetodoDisp("Banco Brubank");
                <%end%>

                <%if bank_galicia > 0%>
                    mostrarMetodoDisp("Banco Galicia");
                <%end%>
                break;

            case "Brasil":
                
                <%if bank_do_brasil > 0%>
                    mostrarMetodoDisp("Banco Do Brasil");
                <%end%>

                <%if bank_bradesco > 0%>
                    mostrarMetodoDisp("Bradesco");
                <%end%>

                <%if bank_caixa > 0%>
                    mostrarMetodoDisp("Caixa");
                <%end%>

                <%if bank_itau > 0%>
                    mostrarMetodoDisp("Itaú");
                <%end%>

                <%if bank_iti > 0%>
                    mostrarMetodoDisp("Ití");
                <%end%>

                <%if bank_nubank > 0%>
                    mostrarMetodoDisp("Nubank");
                <%end%>

                <%if bank_santander > 0%>
                    mostrarMetodoDisp("Santander");
                <%end%>

                <%if wallet_brasil > 0%>
                    mostrarMetodoDisp("Pix");
                <%end%>

                <%if wallet_with_user_brasil > 0%>
                    mostrarMetodoDisp("Pic Pay");
                <%end%>
                break;

            case "Chile":
                
                <%if bank_chile > 0%>
                    mostrarMetodoDisp("Banco Estado");
                <%end%>
                break;

            case "Colombia":
                
                <%if bank_colombia > 0%>
                    mostrarMetodoDisp("Bancolombia");
                <%end%>

                <%if digital_payments > 0%>
                    mostrarMetodoDisp("Nequi");
                <%end%>
                break;
            
            case "Ecuador":
                
                <%if bank_ecuador > 0%>
                    mostrarMetodoDisp("Banco Pichincha");
                <%end%>
                break;
            
            case "Panama":
                
                <%if bank_bankia > 0%>
                    mostrarMetodoDisp("Bankia");
                <%end%>

                <%if bank_santander_pan > 0%>
                    mostrarMetodoDisp("Santander");
                <%end%>
                break;
            
            case "Peru":
                
                <%if bank_bcp > 0%>
                    mostrarMetodoDisp("Banco BCP");
                <%end%>

                <%if bank_escotia_bank > 0%>
                    mostrarMetodoDisp("Escotia Bank");
                <%end%>
                break;
            
            case "USA":
                
                <%if wallet_usa > 0%>
                    mostrarMetodoDisp("Zelle");
                <%end%>

                break;
            
            case "Venezuela":
                var span = document.createElement("span");
                var content = document.createTextNode("Para transferencias de un mismo banco");
                var br = document.createElement("br");
                var br2 = document.createElement("br");

                span.appendChild(content);
                span.classList.add("font-italic")
                article.appendChild(span);
                article.appendChild(br);
                article.appendChild(br2);
                <%if bank_vzla > 0%>
                    mostrarMetodoDisp("Banco De Venezuela");
                <%end%>

                <%if bank_mercantil > 0%>
                    mostrarMetodoDisp("Banco Mercantil");
                <%end%>

                <%if bank_bod > 0%>
                    mostrarMetodoDisp("Banco B.O.D");
                <%end%>

                <%if bank_banesco > 0%>
                    mostrarMetodoDisp("Banco Banesco");
                <%end%>
                article.appendChild(br);
                var span = document.createElement("span");
                var content = document.createTextNode("Para transferencias de otro banco");
                var br = document.createElement("br");

                span.appendChild(content);
                span.classList.add("font-italic")
                article.appendChild(span);
                article.appendChild(br);
                
                var link = document.createElement("a");
                var content = document.createTextNode("Ver Bancos");
                var br = document.createElement("br");
                var br2 = document.createElement("br");

                link.appendChild(content);
                link.setAttribute("role","button")
                link.setAttribute("data-toggle","modal")
                link.setAttribute("data-target","#list-methods")
                link.classList.add("special-link","alert-link")
                article.appendChild(link);
                article.appendChild(br);
                article.appendChild(br2);

                <%if mobile_payments > 0%>
                    mostrarMetodoDisp("Pago Movil");
                <%end%>
                break;
        }

        listaMetodos.classList.remove("d-none");
        
    }

    //FUNCIONES DEL SELECT PAIS
    spanCountry = document.getElementById("country");
    msjAñadirAccount = document.getElementById("añadirAccount");

    function sugerirAñadirAccount(country){
        
        spanCountry.innerHTML = country;
        msjAñadirAccount.classList.remove("d-none");
    }
    
    function optionBanks(country){
        console.log(country);
        account = 0;
        j = 1;
        do {
            var selectBox = document.getElementById("opcionesAccountUserDestino"+j);
            options = selectBox.childNodes;

            if (options.length > 0){
                limit = options.length
                for (i=0; i < limit; i++){
                    selectBox.removeChild(options[0]);   
                }
            }
            <%if current_user.banks.where(view:true).count > 0%>    
                <%current_user.banks.order("banco DESC").where(view:true).each do |bank_user|%>
                    if ("<%=bank_user.country%>" === country){
                        <%admin.banks.where(view:true).each do |bank_admin| %>  
                            <%if bank_admin.status === "activo"%>
                                <%if bank_admin.banco === bank_user.banco || AvalaibleBank.where(bank: bank_user.banco).present?%>
                                    //ENLACE
                                    var enlace = document.createElement("a")
                                    enlace.setAttribute("href","#")
                                    enlace.setAttribute("id","banks-<%=bank_user.id%>")
                                    if (j === 1){
                                        enlace.setAttribute("onclick","activarEnlace(event)");
                                    }else{
                                        enlace.setAttribute("onclick","activarEnlace2(event,"+j+")");
                                    }
                                    
                                    /*PARA CORREGIR ALTERACION DE VS-CODE EN EL CODIGO*/
                                    switch(enlace){
                                        case "asdasdasdasd":
                 
                                            break;
                                    }
                                    
                                    enlace.classList.add("opcion");
                                    
                                    //DIV PADRE
                                    divPadre = document.createElement("div");
                                    divPadre.classList.add("contenido-opcion");
                                    
                                    //IMAGEN
                                    img = document.createElement("img");
                                    img.setAttribute("src","/img/bancos/<%=bank_user.banco%>.png");

                                    //SPAN NOMBRE DEL TITULAR
                                    spanTitular = document.createElement("span");
                                    spanTitular.innerHTML = "<%=bank_user.name%> <%=bank_user.second_name%> <%=bank_user.last_name%>";
                                    spanTitular.classList.add("titulo","text-capitalize");


                                    //DIV HIJO
                                    divHijo = document.createElement("div");
                                    divHijo.classList.add("textos","text-left");

                                    //H1
                                    h2 = document.createElement("h2");
                                    h2.classList.add("titulo","tam-h2");
                                    <%part1 = bank_user.number_account[0, 4]%>
                                    <%part2 = bank_user.number_account[-4,4]%>
                                    var content = document.createTextNode("<%=part1%>********<%=part2%>");
                                    
                                    h2.appendChild(content);
                                    divHijo.appendChild(spanTitular);
                                    divHijo.appendChild(h2);
                                    divPadre.appendChild(img);
                                    divPadre.appendChild(divHijo);
                                    enlace.appendChild(divPadre);
                                    selectBox.appendChild(enlace);
                                    if (j===1){
                                        account += 1;
                                    }
                                   
                                    <%break%>
                                    
                                <%end%>       
                            <%end%>
                        <%end%>
                    }
                <%end%>
            <%end%>
            j++
        } while (country==="Venezuela" && j <= 3);
        
        return account;
    }

    function optionBanksBrasil(country){
        account = 0;
        j = 1;
        do {
            var selectBox = document.getElementById("opcionesAccountUserDestino"+j);
            options = selectBox.childNodes;

            if (options.length > 0){
                limit = options.length
                for (i=0; i < limit; i++){
                    selectBox.removeChild(options[0]);   
                }
            }
            <%if current_user.bank_brasils.where(view:true).count > 0%>  
                <%current_user.bank_brasils.order("bank DESC").where(view:true).each do |bank_user|%>
                    if ("<%=bank_user.country%>" === country){
                        <%admin.bank_brasils.where(view:true).each do |bank_admin| %>
                            <%if bank_admin.status === "activo"%>
                                <%if bank_admin.bank === bank_user.bank%>
                                    //ENLACE
                                    var enlace = document.createElement("a");
                                    enlace.setAttribute("href","#");
                                    enlace.setAttribute("id","bank_brasils-<%=bank_user.id%>");
                                    if (j === 1){
                                        enlace.setAttribute("onclick","activarEnlace(event)");
                                    }else{
                                        enlace.setAttribute("onclick","activarEnlace2(event,"+j+")");
                                    }
                                    enlace.classList.add("opcion");

                                    //DIV PADRE
                                    var divPadre = document.createElement("div");
                                    divPadre.classList.add("contenido-opcion");
                                    
                                    //IMAGEN
                                    var img = document.createElement("img");
                                    img.setAttribute("src","/img/bancos/<%=bank_user.bank%>.png");

                                   //SPAN NOMBRE DEL TITULAR
                                    spanTitular = document.createElement("span");
                                    spanTitular.innerHTML = "<%=bank_user.name%> <%=bank_user.second_name%> <%=bank_user.last_name%>";
                                    spanTitular.classList.add("titulo","text-capitalize");

                                    //DIV HIJO
                                    divHijo = document.createElement("div");
                                    divHijo.classList.add("textos","text-left");

                                    //H1
                                    var h2 = document.createElement("h2");
                                    h2.classList.add("titulo","tam-h2");
                                    <%part1 = bank_user.number_account[0, 4]%>
                                    <%part2 = bank_user.number_account[-4,4]%>
                                    var content = document.createTextNode("<%=part1%>****<%=part2%>");
                                    
                                    h2.appendChild(content);
                                    divHijo.appendChild(spanTitular);
                                    divHijo.appendChild(h2);
                                    divPadre.appendChild(img);
                                    divPadre.appendChild(divHijo);
                                    enlace.appendChild(divPadre);
                                    selectBox.appendChild(enlace);
                                    if (j===1){
                                        account += 1;
                                    }
                                    <%break%>
                                <%end%>
                            <%end%>
                        <%end%>
                    }
                <%end%>
            <%end%>
            j++
        } while (country==="Venezuela" && j <= 3);
        return account;
    }

    function optionWallets(country){

        account = 0;
        j = 1;
        do {
            var selectBox = document.getElementById("opcionesAccountUserDestino"+j);
            
            if (country === "USA"){
                options = selectBox.childNodes;

                if (options.length > 0){
                    limit = options.length
                    for (i=0; i < limit; i++){
                        selectBox.removeChild(options[0]);   
                    }
                }
            }
            <%if current_user.wallets.where(view:true).count > 0%>    
                <%current_user.wallets.order("wallet_name DESC").where(view:true).each do |wallet_user|%>
                    if ("<%=wallet_user.country%>" === country){
                        <%admin.wallets.where(view:true).each do |wallet_admin| %>
                            <%if wallet_admin.status === "activo"%>
                                <%if wallet_admin.wallet_name === wallet_user.wallet_name%>
                                    //ENLACE
                                    var enlace = document.createElement("a");
                                    enlace.setAttribute("href","#");
                                    enlace.setAttribute("id","wallets-<%=wallet_user.id%>");
                                    if (j === 1){
                                        enlace.setAttribute("onclick","activarEnlace(event)");
                                    }else{
                                        enlace.setAttribute("onclick","activarEnlace2(event,"+j+")");
                                    }
                                    enlace.classList.add("opcion");

                                    //DIV PADRE
                                    var divPadre = document.createElement("div");
                                    divPadre.classList.add("contenido-opcion");
                                    
                                    //IMAGEN
                                    var img = document.createElement("img");
                                    img.setAttribute("src","/img/wallets/<%=wallet_user.wallet_name%>.png");

                                    //SPAN NOMBRE DEL TITULAR
                                    spanTitular = document.createElement("span");
                                    spanTitular.innerHTML = "<%=wallet_user.name%> <%=wallet_user.second_name%> <%=wallet_user.last_name%>";
                                    spanTitular.classList.add("titulo","text-capitalize");

                                    //DIV HIJO
                                    divHijo = document.createElement("div");
                                    divHijo.classList.add("textos","text-left");

                                    //H1
                                    var h2 = document.createElement("h2");
                                    h2.classList.add("titulo","tam-h2");
                                    <%part1 = wallet_user.identificador[0, 4]%>
                                    <%part2 = wallet_user.identificador[-8,8]%>
                                    var content = document.createTextNode("<%=part1%>****<%=part2%>");
                                    
                                    h2.appendChild(content);
                                    divHijo.appendChild(spanTitular);
                                    divHijo.appendChild(h2);
                                    divPadre.appendChild(img);
                                    divPadre.appendChild(divHijo);
                                    enlace.appendChild(divPadre);
                                    selectBox.appendChild(enlace);
                                    if (j===1){
                                        account += 1;
                                    }
                                    <%break%>
                                <%end%>
                            <%end%>
                        <%end%>
                    }
                <%end%>
            <%end%>
            j++
        } while (country==="Venezuela" && j <= 3);
        return account; 
    }

    function optionWalletsWithUser(country){
        account = 0;
        j = 1;
        do {
            var selectBox = document.getElementById("opcionesAccountUserDestino"+j);
            
            if (country != "Brasil"){
                options = selectBox.childNodes;

                if (options.length > 0){
                    limit = options.length
                    for (i=0; i < limit; i++){
                        selectBox.removeChild(options[0]);   
                    }
                }
            }
            <%if current_user.wallet_with_users.where(view:true).count > 0%>    
                <%current_user.wallet_with_users.order("wallet_name DESC").where(view:true).each do |wallet_user|%>
                    if ("<%=wallet_user.country%>" === country){
                        <%admin.wallet_with_users.where(view:true).each do |wallet_admin| %>
                            <%if wallet_admin.status === "activo"%>
                                <%if wallet_admin.wallet_name === wallet_user.wallet_name%>
                                    //ENLACE
                                    var enlace = document.createElement("a");
                                    enlace.setAttribute("href","#");
                                    enlace.setAttribute("id","wallet_with_users-<%=wallet_user.id%>");
                                    if (j === 1){
                                        enlace.setAttribute("onclick","activarEnlace(event)");
                                    }else{
                                        enlace.setAttribute("onclick","activarEnlace2(event,"+j+")");
                                    }
                                    enlace.classList.add("opcion");

                                    //DIV PADRE
                                    var divPadre = document.createElement("div");
                                    divPadre.classList.add("contenido-opcion");
                                    
                                    //IMAGEN
                                    var img = document.createElement("img");
                                    img.setAttribute("src","/img/wallets/<%=wallet_user.wallet_name%>.png");

                                    //SPAN NOMBRE DEL TITULAR
                                    spanTitular = document.createElement("span");
                                    spanTitular.innerHTML = "<%=wallet_user.name%> <%=wallet_user.second_name%> <%=wallet_user.last_name%>";
                                    spanTitular.classList.add("titulo","text-capitalize");

                                    //DIV HIJO
                                    divHijo = document.createElement("div");
                                    divHijo.classList.add("textos","text-left");

                                    //H1
                                    var h2 = document.createElement("h2");
                                    h2.classList.add("titulo","tam-h2");
                                    <%part1 = wallet_user.usuario[0, 3]%>
                                    <%part2 = wallet_user.usuario[-3,3]%>
                                    var content = document.createTextNode("<%=part1%>****<%=part2%>");
                                    
                                    h2.appendChild(content);
                                    divHijo.appendChild(spanTitular);
                                    divHijo.appendChild(h2);
                                    divPadre.appendChild(img);
                                    divPadre.appendChild(divHijo);
                                    enlace.appendChild(divPadre);
                                    selectBox.appendChild(enlace);
                                    if (j===1){
                                        account += 1;
                                    }
                                    <%break%>
                                <%end%>
                            <%end%>
                        <%end%>
                    }
                <%end%>
            <%end%>
            j++
        } while (country==="Venezuela" && j <= 3);
        return account; 
        
    }

    function optionDigitalPayments(country){
        account = 0;
        j = 1;
        do {
            var selectBox = document.getElementById("opcionesAccountUserDestino"+j);

            if(country != "Colombia"){
                options = selectBox.childNodes;

                if (options.length > 0){
                    limit = options.length
                    for (i=0; i < limit; i++){
                        selectBox.removeChild(options[0]);   
                    }
                }
            }

            <%if current_user.digital_payments.where(view:true).count > 0%>    
                <%current_user.digital_payments.order("payment_method DESC").where(view:true).each do |payment_user|%>
                    if ("<%=payment_user.country%>" === country){
                        <%admin.digital_payments.where(view:true).each do |payment_admin| %>
                            <%if payment_admin.status === "activo"%>
                                <%if payment_admin.payment_method === payment_user.payment_method%>
                                    //ENLACE
                                    var enlace = document.createElement("a");
                                    enlace.setAttribute("href","#");
                                    enlace.setAttribute("id","digital_payments-<%=payment_user.id%>");
                                    if (j === 1){
                                        enlace.setAttribute("onclick","activarEnlace(event)");
                                    }else{
                                        enlace.setAttribute("onclick","activarEnlace2(event,"+j+")");
                                    }
                                    enlace.classList.add("opcion");

                                    //DIV PADRE
                                    var divPadre = document.createElement("div");
                                    divPadre.classList.add("contenido-opcion");
                                    
                                    //IMAGEN
                                    var img = document.createElement("img");
                                    img.setAttribute("src","/img/wallets/<%=payment_user.payment_method%>.png");

                                    //SPAN NOMBRE DEL TITULAR
                                    spanTitular = document.createElement("span");
                                    spanTitular.innerHTML = "<%=payment_user.name%> <%=payment_user.second_name%> <%=payment_user.last_name%>";
                                    spanTitular.classList.add("titulo","text-capitalize");

                                    //DIV HIJO
                                    divHijo = document.createElement("div");
                                    divHijo.classList.add("textos","text-left");

                                    //H1
                                    var h2 = document.createElement("h2");
                                    h2.classList.add("titulo","tam-h2");
                                    <%part1 = payment_user.number_phone[0, 3]%>
                                    <%part2 = payment_user.number_phone[-3,3]%>
                                    var content = document.createTextNode("<%=part1%>****<%=part2%>");
                                    
                                    h2.appendChild(content);
                                    divHijo.appendChild(spanTitular);
                                    divHijo.appendChild(h2);
                                    divPadre.appendChild(img);
                                    divPadre.appendChild(divHijo);
                                    enlace.appendChild(divPadre);
                                    selectBox.appendChild(enlace);
                                    if (j===1){
                                        account += 1;
                                    }
                                    <%break%>
                                <%end%>
                            <%end%>
                        <%end%>
                    }
                <%end%>
            <%end%>
            j++
        } while (country==="Venezuela" && j <= 3);
        return account;
    }
    
    function optionMobilePayments(country){
        account = 0;
        j = 1;
        do {
            var selectBox = document.getElementById("opcionesAccountUserDestino"+j);
            
            <%if current_user.mobile_payments.where(view:true).count > 0%>    
                <%current_user.mobile_payments.order("bank DESC").where(view:true).each do |payment_user|%>
                    if ("<%=payment_user.country%>" === country){
                        <% if admin.mobile_payments.where(view:true,status:"activo").count > 0%>   

                            //ENLACE
                            var enlace = document.createElement("a");
                            enlace.setAttribute("href","#");
                            enlace.setAttribute("id","mobile_payments-<%=payment_user.id%>");
                            if (j === 1){
                                enlace.setAttribute("onclick","activarEnlace(event)");
                            }else{
                                enlace.setAttribute("onclick","activarEnlace2(event,"+j+")");
                            }
                            enlace.classList.add("opcion");

                            //DIV PADRE
                            var divPadre = document.createElement("div");
                            divPadre.classList.add("contenido-opcion");
                            
                            //IMAGEN
                            var img = document.createElement("img");
                            img.setAttribute("src","/img/bancos/<%=payment_user.bank%>.png");
                            img.setAttribute("alt","<%=payment_user.bank%>")
                            img.setAttribute("id","img-bank-payment")

                            //SPAN NOMBRE DEL TITULAR
                            spanTitular = document.createElement("span");
                            spanTitular.innerHTML = "<%=payment_user.name%> <%=payment_user.second_name%> <%=payment_user.last_name%>";
                            spanTitular.classList.add("titulo","text-capitalize");

                            //DIV HIJO
                            var divHijo = document.createElement("div");
                            divHijo.classList.add("textos","text-left");

                            //H1
                            var h2 = document.createElement("h2");
                            h2.classList.add("titulo","tam-h2");
                            <%part1 = payment_user.number_phone[0, 3]%>
                            <%part2 = payment_user.number_phone[-4,4]%>
                            var content = document.createTextNode("<%=part1%>****<%=part2%>");
                            
                            h2.appendChild(content);
                            divHijo.appendChild(spanTitular);
                            divHijo.appendChild(h2);
                            divPadre.appendChild(img);
                            divPadre.appendChild(divHijo);
                            enlace.appendChild(divPadre);
                            selectBox.appendChild(enlace);
                            if (j===1){
                                account += 1;
                            }
                        <%end%>
                    }
                <%end%>
            <%end%>
            j++
        } while (country==="Venezuela" && j <= 3);
        return account;
    }

    function habilitarAccountDestinity(country) {
        bankStandar = 0;
        bankSpecialBrasil = 0;
        wallet = 0;
        wallet_with_user = 0;
        paymentDigital = 0;
        mobilePayment = 0;

        switch (country){
            case "Argentina":
                     
                bankStandar = optionBanks(country);
                existMetodosUser = bankStandar;
                break;

            case "Brasil":
                      
                bankSpecialBrasil = optionBanksBrasil(country);   
                wallet = optionWallets(country);
                wallet_with_user = optionWalletsWithUser(country);
                existMetodosUser = bankSpecialBrasil + wallet + wallet_with_user;
                break;

            case "Chile":         
                      
                bankStandar = optionBanks(country); 
                existMetodosUser = bankStandar;   
                break;
            
            case "Colombia":         
                       
                bankStandar = optionBanks(country);   
                paymentDigital = optionDigitalPayments(country);
                existMetodosUser = bankStandar + paymentDigital;
                break;

            case "Ecuador":         
                     
                bankStandar = optionBanks(country);
                existMetodosUser = bankStandar;
                break;

            case "España":         
                      
                bankStandar = optionBanks(country);
                existMetodosUser = bankStandar;
                break;

            case "Panama":         
                bankStandar = optionBanks(country);
                existMetodosUser = bankStandar;
                break;

            case "Peru":         
                       
                bankStandar = optionBanks(country);   
                existMetodosUser = bankStandar;
                break;

            case "USA":         
                
                wallet = optionWallets(country);
                existMetodosUser = wallet;
                break;

            case "Venezuela":
                
                bankStandar = optionBanks(country);   
                mobilePayment = optionMobilePayments(country);
                existMetodosUser = bankStandar + mobilePayment; 
                break;
        
            default:
                break;
        }
        //RESETEAR CAMPO ELEGIR CUENTA DESTINO USER, CUENTA DESTINO ADMIN Y METODO DE PAGO 
        campoAccountDestinity = document.getElementById("contenidoSelectAccountUserDestinity");
        if(document.getElementById("inputPais").value === "Venezuela"){
            campoAccountDestinity.innerHTML = "<h2 class='titulo' id='tituloAccountUserDestino'>Cuenta Nro. 1</h2>"
        }else{
            campoAccountDestinity.innerHTML = "<h2 class='titulo' id='tituloAccountUserDestino'>Elige una opcion</h2>"
        }
        
        campoAccountAdminDestinity = document.getElementById("contenidoSelectAccountAdminDestinity");
        campoAccountAdminDestinity.innerHTML = "<h2 class='titulo' id='tituloAccountAdminDestino'>Elige una opcion</h2>"

        campoMetodoPago = document.getElementById("contenidoSelectMetodoPago");
        campoMetodoPago.innerHTML = "<h2 class='titulo' id='tituloMetodoPago'>Elige una opcion</h2>"

        //OCULTAR CAJAS 3,4 Y 5
        caja3 = document.getElementById("accountAdminDestinity")
        caja4 = document.getElementById("metodosPago");
        caja5 = document.getElementById("montoEnvio");

        caja3.classList.add("d-none");
        caja4.classList.add("d-none");
        caja5.classList.add("d-none");

        metodosDisp(country);

        if (existMetodosUser > 0){
            spanInfoPaisDestino = document.getElementById("spanPaisDestino");
            spanInfoPaisDestino.innerHTML = country;
            infoComisionPagoMovil = document.getElementById("info-comision-pago-movil")
            if (spanInfoPaisDestino.innerHTML === "Venezuela"){
                
                infoComisionPagoMovil.classList.remove("d-none")
            }else{
                infoComisionPagoMovil.classList.add("d-none")
            }
            msjAñadirAccount.classList.add("d-none");
            accountUserDestinity.classList.remove("d-none");

        }else{
            accountUserDestinity.classList.add("d-none");
            sugerirAñadirAccount(country);
        }
        
    }

    function activarFuncionSelectBoxPaisDestinity(){
        
        contenidoSelectPaisDestino = document.querySelector('#selectPaisDestino .contenido-select');
        hiddenInputPaisDestino = document.querySelector('#inputPais');
        

        document.querySelectorAll('#opcionesPaisDestino > .opcion').forEach((opcion) => {
            opcion.addEventListener('click', (e) => {
                e.preventDefault();
                contenidoSelectPaisDestino.innerHTML = e.currentTarget.innerHTML;
                selectPaisDestino.classList.toggle('active');
                opcionesPaisDestino.classList.toggle('active');
                hiddenInputPaisDestino.value = e.currentTarget.querySelector('.titulo').innerText;
                document.getElementById("detail-pais-destino").innerHTML = e.currentTarget.querySelector('.titulo').innerText;
                habilitarAccountDestinity(hiddenInputPaisDestino.value);
                btn_añadir_account.classList.add('d-none')
            });
        });

        selectPaisDestino.addEventListener('click', () => {
            selectPaisDestino.classList.toggle('active');
            opcionesPaisDestino.classList.toggle('active');
            //INACTIVAR SELECT BOX ACCOUNT USER
            selectAccountUserDestino.classList.remove('active');
            opcionesAccountUserDestino.classList.remove('active');
            document.getElementById("contenedorAccountUser2").classList.add("d-none")
            document.getElementById("contenedorAccountUser3").classList.add("d-none")
            document.getElementById("btn-eliminar-account").classList.add("d-none")
            
            //INACTIVAR SELECT BOX ACCOUNT ADMIN
            selectAccountAdminDestino.classList.remove('active');
            opcionesAccountAdminDestino.classList.remove('active');
            //INACTIVAR SELECT BOX METODOS DE PAGO
            selectMetodoPago.classList.remove('active'); 
            opcionesMetodoPago.classList.remove('active'); 
        });
    }

    activarFuncionSelectBoxPaisDestinity();
    
    //SELECT BOX CUENTA DESTINO DEL USUARIO
    function activarFuncionSelectBoxAccountDestinityUser(select,div_num){
        
        if (div_num === 1){
            select.classList.toggle('active')
            selectAccountUserDestino2.classList.remove('active');
            selectAccountUserDestino3.classList.remove('active');
            opcionesAccountUserDestino.classList.toggle('active');
            opcionesAccountUserDestino2.classList.remove('active');
            opcionesAccountUserDestino3.classList.remove('active');
            
        }else if (div_num === 2){
            select.classList.toggle('active')
            selectAccountUserDestino.classList.remove('active');
            selectAccountUserDestino3.classList.remove('active');
            opcionesAccountUserDestino2.classList.toggle('active');
            opcionesAccountUserDestino.classList.remove('active');
            opcionesAccountUserDestino3.classList.remove('active');
            
        }else if (div_num === 3){
            select.classList.toggle('active')
            selectAccountUserDestino.classList.remove('active');
            selectAccountUserDestino2.classList.remove('active');
            opcionesAccountUserDestino3.classList.toggle('active');
            opcionesAccountUserDestino.classList.remove('active');
            opcionesAccountUserDestino2.classList.remove('active');
           
        }

        //INACTIVAR SELECT BOX PAIS DESTINO
        selectPaisDestino.classList.remove('active');
        opcionesPaisDestino.classList.remove('active');

        //INACTIVAR SELECT BOX ACCOUNT ADMIN
        selectAccountAdminDestino.classList.remove('active');
        opcionesAccountAdminDestino.classList.remove('active');
        

        //INACTIVAR SELECT BOX METODOS DE PAGO
        selectMetodoPago.classList.remove('active'); 
        opcionesMetodoPago.classList.remove('active'); 
    }

    function activarEnlace(e){
        e.preventDefault();
        accountAdminDestino = document.querySelector('#accountAdminDestinity');
        contenidoSelectAccountUserDestino = document.querySelector('#selectAccountUserDestino .contenido-select');
        hiddenInputAccountUserDestino = document.querySelector('#inputAccountUserDestino');

        contenidoSelectAccountUserDestino.innerHTML = e.currentTarget.innerHTML;
        selectAccountUserDestino.classList.toggle('active');
        opcionesAccountUserDestino.classList.toggle('active');
        hiddenInputAccountUserDestino.value = e.currentTarget.id;
        document.getElementById("detail-cuenta-credito-usuario").innerHTML = e.currentTarget.querySelector('.titulo').innerText + " / " + e.currentTarget.querySelector('.tam-h2').innerText;
        accountAdminDestino.classList.remove("d-none");

        if(document.getElementById("inputPais").value === "Venezuela"){
            btn_añadir_account.classList.remove("d-none")
            
            for(j=1; j<=3; j++){
                
                if (j === 2){
                    valor_aux = document.querySelector('#inputAccountUserDestino3').value;
                }else if(j === 3){
                    valor_aux = document.querySelector('#inputAccountUserDestino2').value;
                }
                
                if (j != 1){
                    selectBox = document.getElementById("opcionesAccountUserDestino"+j);
                    options = selectBox.childNodes;
        
                    if (options.length > 0){
                        limit = options.length
                        for (i=0; i < limit; i++){
                            
                            if (options[i].id != e.currentTarget.id && valor_aux != options[i].id){
                                options[i].classList.remove("d-none");
                                
                            }      
                        }
                        
                        for (i=0; i < limit; i++){
                            if (options[i].id === e.currentTarget.id){
                                options[i].classList.add("d-none");
                                break; 
                            }  
                        }
                    }
                }
            }
            
        }
    }
    function activarEnlace2(e,opcion_num){
        e.preventDefault();
        contenidoSelectAccountUserDestino = document.querySelector('#selectAccountUserDestino'+opcion_num+' .contenido-select');
        hiddenInputAccountUserDestino = document.querySelector('#inputAccountUserDestino'+opcion_num);
        hiddenInputAccountUserDestino.value = e.currentTarget.id;
        contenidoSelectAccountUserDestino.innerHTML = e.currentTarget.innerHTML;
        

        if (opcion_num === 2){
            document.getElementById("detail-cuenta-credito-usuario2").innerHTML = e.currentTarget.querySelector('.titulo').innerText + " / " + e.currentTarget.querySelector('.tam-h2').innerText;;
            document.getElementById("div-detail-account-usuario2").classList.remove("d-none")
            selectAccountUserDestino2.classList.toggle('active');
            opcionesAccountUserDestino2.classList.toggle('active');

            for(j=1; j<=3; j++){
                
                if (j === 1){
                    valor_aux = document.querySelector('#inputAccountUserDestino3').value;
                }else if(j === 3){
                    valor_aux = document.querySelector('#inputAccountUserDestino').value;
                }
                
                if (j != opcion_num){
                    selectBox = document.getElementById("opcionesAccountUserDestino"+j);
                    options = selectBox.childNodes;
        
                    if (options.length > 0){
                        limit = options.length
                        for (i=0; i < limit; i++){
                            
                            if (options[i].id != e.currentTarget.id && valor_aux != options[i].id){
                                options[i].classList.remove("d-none");
                                
                            }      
                        }
                        
                        for (i=0; i < limit; i++){
                            if (options[i].id === e.currentTarget.id){
                                options[i].classList.add("d-none");
                                break; 
                            }  
                        }
                    }
                }
            }
        }else if (opcion_num === 3){
            document.getElementById("detail-cuenta-credito-usuario3").innerHTML = e.currentTarget.querySelector('.titulo').innerText + " / " + e.currentTarget.querySelector('.tam-h2').innerText;;
            document.getElementById("div-detail-account-usuario3").classList.remove("d-none")
            selectAccountUserDestino3.classList.toggle('active');
            opcionesAccountUserDestino3.classList.toggle('active');

            for(j=1; j<=3; j++){
                
                if (j === 1){
                    valor_aux = document.querySelector('#inputAccountUserDestino2').value;
                }else if(j === 2){
                    valor_aux = document.querySelector('#inputAccountUserDestino').value;
                }
                
                if (j != opcion_num){
                    selectBox = document.getElementById("opcionesAccountUserDestino"+j);
                    options = selectBox.childNodes;
        
                    if (options.length > 0){
                        limit = options.length
                        for (i=0; i < limit; i++){
                            
                            if (options[i].id != e.currentTarget.id && valor_aux != options[i].id){
                                options[i].classList.remove("d-none");
                                
                            }      
                        }
                        
                        for (i=0; i < limit; i++){
                            if (options[i].id === e.currentTarget.id){
                                options[i].classList.add("d-none");
                                break; 
                            }  
                        }
                    }
                }
            }
        }
    }

    contenedorAccountUser2 = document.getElementById("contenedorAccountUser2")
    contenedorAccountUser3 = document.getElementById("contenedorAccountUser3")
    function añadirCuentasUser(e){
        e.preventDefault();
        
        if(contenedorAccountUser2.classList.value === "contenedor d-none"){
            contenedorAccountUser2.classList.remove("d-none")
            btn_eliminar_account.classList.remove("d-none")

            selectBox = opcionesAccountUserDestino3
            options = selectBox.childNodes

            if (options.length <= 2){
                btn_añadir_account.classList.add("d-none")
            }
        }else if(contenedorAccountUser3.classList.value === "contenedor d-none"){
            contenedorAccountUser3.classList.remove("d-none")
            btn_añadir_account.classList.add("d-none")
        }
    }

    function eliminarCuentasUser(e){
        e.preventDefault();

        if(contenedorAccountUser3.classList.value === "contenedor"){
            contenedorAccountUser3.classList.add("d-none")
            btn_añadir_account.classList.remove("d-none")
            selectAccountUserDestino3.classList.remove('active')
            opcionesAccountUserDestino3.classList.remove('active')

            valor = document.getElementById("inputAccountUserDestino3").value
            for(j=1; j<=3; j++){
                selectBox = document.getElementById("opcionesAccountUserDestino"+j);
                options = selectBox.childNodes;

                if (options.length > 0){
                    limit = options.length
                    for (i=0; i < limit; i++){
                        if (options[i].id === valor){
                            options[i].classList.remove("d-none");
                            break; 
                        }      
                    }
                }
            }

            campoAccountDestinity = document.getElementById("contenidoSelectAccountUserDestinity3");
            campoAccountDestinity.innerHTML = "<h2 class='titulo' id='tituloAccountUserDestino'>Cuenta Nro. 3</h2>"
            hiddenInputAccountUserDestino = document.querySelector('#inputAccountUserDestino3');
            hiddenInputAccountUserDestino.value = ""
            document.getElementById("detail-cuenta-credito-usuario3").innerHTML = ""
            document.getElementById("div-detail-account-usuario3").classList.add("d-none")

        }else if(contenedorAccountUser2.classList.value === "contenedor"){

            contenedorAccountUser2.classList.add("d-none")
            btn_eliminar_account.classList.add("d-none")
            btn_añadir_account.classList.remove("d-none")
            selectAccountUserDestino2.classList.remove('active')
            opcionesAccountUserDestino2.classList.remove('active')

            valor = document.getElementById("inputAccountUserDestino2").value
            for(j=1; j<=3; j++){
                selectBox = document.getElementById("opcionesAccountUserDestino"+j);
                options = selectBox.childNodes;

                if (options.length > 0){
                    limit = options.length
                    for (i=0; i < limit; i++){
                        if (options[i].id === valor){
                            options[i].classList.remove("d-none");
                            break; 
                        }      
                    }
                }
            }

            campoAccountDestinity = document.getElementById("contenidoSelectAccountUserDestinity2");
            campoAccountDestinity.innerHTML = "<h2 class='titulo' id='tituloAccountUserDestino'>Cuenta Nro. 2</h2>"
            hiddenInputAccountUserDestino = document.querySelector('#inputAccountUserDestino2');
            hiddenInputAccountUserDestino.value = ""
            document.getElementById("detail-cuenta-credito-usuario2").innerHTML = ""
            document.getElementById("div-detail-account-usuario2").classList.add("d-none")
        }
    }

    //SELECT BOX CUENTA DESTINO DEL ADMIN
    function optionBanksAdmin(country){
        var selectBox = document.getElementById("opcionesAccountAdminDestino");

        <%admin.banks.where(view:true).each do |bank_admin|%>
            if ("<%=bank_admin.country%>" === country){
                <%if bank_admin.status === "activo"%>
                //ENLACE
                    var enlace = document.createElement("a");
                    enlace.setAttribute("href","#");
                    enlace.setAttribute("id","banks-<%=bank_admin.id%>");
                    enlace.classList.add("opcion");

                    //DIV PADRE
                    var divPadre = document.createElement("div");
                    divPadre.classList.add("contenido-opcion");
                    
                    //IMAGEN
                    var img = document.createElement("img");
                    img.setAttribute("src","/img/bancos/<%=bank_admin.banco%>.png");

                    //DIV HIJO
                    var divHijo = document.createElement("div");
                    divHijo.classList.add("textos");

                    //H1
                    var h2 = document.createElement("h2");
                    h2.classList.add("titulo","tam-h2");
                    var content = document.createTextNode("<%=bank_admin.banco%>");
                    
                    h2.appendChild(content);
                    divHijo.appendChild(h2);
                    divPadre.appendChild(img);
                    divPadre.appendChild(divHijo);
                    enlace.appendChild(divPadre);
                    selectBox.appendChild(enlace);
                <%end%>
            } 
        <%end%>         
    }

    function optionBanksBrasilAdmin(country){
        var selectBox = document.getElementById("opcionesAccountAdminDestino");

        <%caixaFind = false%>
        <%admin.bank_brasils.where(view:true,status:"activo").each do |bank_admin|%>
            if ("<%=bank_admin.country%>" === country){
                
                <%unless caixaFind && bank_admin.bank === "Caixa"%>
                    //ENLACE
                    var enlace = document.createElement("a");
                    enlace.setAttribute("href","#");
                    <%if bank_admin.bank === "Caixa"%>
                        //RASTREAR AQUI LA CUENTA ESTANDAR DE CAIXA DE OTACAR A DONDE DEPOSITAR Y TRANSFERIR
                        <%if @cupos_for_loterica.present? && @cupos_for_loterica > 0%>
                            enlace.setAttribute("id","caixa-6");
                        <%else%>
                            enlace.setAttribute("id","bank_brasils-6");
                        <%end%>
                        <%caixaFind = true%>
                    <%else%>
                        enlace.setAttribute("id","bank_brasils-<%=bank_admin.id%>");
                    <%end%>
                    enlace.classList.add("opcion");

                    //DIV PADRE
                    var divPadre = document.createElement("div");
                    divPadre.classList.add("contenido-opcion");
                    
                    //IMAGEN
                    var img = document.createElement("img");
                    img.setAttribute("src","/img/bancos/<%=bank_admin.bank%>.png");

                    //DIV HIJO
                    var divHijo = document.createElement("div");
                    divHijo.classList.add("textos");

                    //H1
                    var h2 = document.createElement("h2");
                    h2.classList.add("titulo","tam-h2");
                    var content = document.createTextNode("<%=bank_admin.bank%>");
                    
                    h2.appendChild(content);
                    divHijo.appendChild(h2);
                    divPadre.appendChild(img);
                    divPadre.appendChild(divHijo);
                    enlace.appendChild(divPadre);
                    selectBox.appendChild(enlace);
                <%end%>
            } 
        <%end%>         
    }

    function optionWalletsAdmin(country){
        var selectBox = document.getElementById("opcionesAccountAdminDestino");

        <%admin.wallets.where(view:true).each do |wallet_admin|%>
            if ("<%=wallet_admin.country%>" === country){
                <%if wallet_admin.status === "activo"%>
                //ENLACE
                    var enlace = document.createElement("a");
                    enlace.setAttribute("href","#");
                    enlace.setAttribute("id","wallets-<%=wallet_admin.id%>");
                    enlace.classList.add("opcion");

                    //DIV PADRE
                    var divPadre = document.createElement("div");
                    divPadre.classList.add("contenido-opcion");
                    
                    //IMAGEN
                    var img = document.createElement("img");
                    img.setAttribute("src","/img/wallets/<%=wallet_admin.wallet_name%>.png");

                    //DIV HIJO
                    var divHijo = document.createElement("div");
                    divHijo.classList.add("textos");

                    //H1
                    var h2 = document.createElement("h2");
                    h2.classList.add("titulo","tam-h2");
                    var content = document.createTextNode("<%=wallet_admin.wallet_name%>");
                    
                    h2.appendChild(content);
                    divHijo.appendChild(h2);
                    divPadre.appendChild(img);
                    divPadre.appendChild(divHijo);
                    enlace.appendChild(divPadre);
                    selectBox.appendChild(enlace);
                <%end%>
            } 
        <%end%>         
    }

    function optionWalletsAdminWithUser(country){
        var selectBox = document.getElementById("opcionesAccountAdminDestino");

        <%admin.wallet_with_users.where(view:true).each do |wallet_admin|%>
            if ("<%=wallet_admin.country%>" === country){
                <%if wallet_admin.status === "activo"%>
                //ENLACE
                    var enlace = document.createElement("a");
                    enlace.setAttribute("href","#");
                    enlace.setAttribute("id","wallet_with_users-<%=wallet_admin.id%>");
                    enlace.classList.add("opcion");

                    //DIV PADRE
                    var divPadre = document.createElement("div");
                    divPadre.classList.add("contenido-opcion");
                    
                    //IMAGEN
                    var img = document.createElement("img");
                    img.setAttribute("src","/img/wallets/<%=wallet_admin.wallet_name%>.png");

                    //DIV HIJO
                    var divHijo = document.createElement("div");
                    divHijo.classList.add("textos");

                    //H1
                    var h2 = document.createElement("h2");
                    h2.classList.add("titulo","tam-h2");
                    var content = document.createTextNode("<%=wallet_admin.wallet_name%>");
                    
                    h2.appendChild(content);
                    divHijo.appendChild(h2);
                    divPadre.appendChild(img);
                    divPadre.appendChild(divHijo);
                    enlace.appendChild(divPadre);
                    selectBox.appendChild(enlace);
                <%end%>
            } 
        <%end%>         
    }

    function optionDigitalPaymentsAdmin(country){
        var selectBox = document.getElementById("opcionesAccountAdminDestino");

        <%admin.digital_payments.where(view:true).each do |payment_admin|%>
            if ("<%=payment_admin.country%>" === country){
                <%if payment_admin.status === "activo"%>
                //ENLACE
                    var enlace = document.createElement("a");
                    enlace.setAttribute("href","#");
                    enlace.setAttribute("id","digital_payments-<%=payment_admin.id%>");
                    enlace.classList.add("opcion");

                    //DIV PADRE
                    var divPadre = document.createElement("div");
                    divPadre.classList.add("contenido-opcion");
                    
                    //IMAGEN
                    var img = document.createElement("img");
                    img.setAttribute("src","/img/wallets/<%=payment_admin.payment_method%>.png");

                    //DIV HIJO
                    var divHijo = document.createElement("div");
                    divHijo.classList.add("textos");

                    //H1
                    var h2 = document.createElement("h2");
                    h2.classList.add("titulo","tam-h2");
                    var content = document.createTextNode("<%=payment_admin.payment_method%>");
                    
                    h2.appendChild(content);
                    divHijo.appendChild(h2);
                    divPadre.appendChild(img);
                    divPadre.appendChild(divHijo);
                    enlace.appendChild(divPadre);
                    selectBox.appendChild(enlace);
                <%end%>
            } 
        <%end%>         
    }

    function optionMobilePaymentsAdmin(country){
        var selectBox = document.getElementById("opcionesAccountAdminDestino");

        <%admin.mobile_payments.where(view:true).each do |payment_admin|%>
            if ("<%=payment_admin.country%>" === country){
                <%if payment_admin.status === "activo"%>
                    //ENLACE
                    var enlace = document.createElement("a");
                    enlace.setAttribute("href","#");
                    enlace.setAttribute("id","mobile_payments-<%=payment_admin.id%>");
                    enlace.classList.add("opcion");

                    //DIV PADRE
                    var divPadre = document.createElement("div");
                    divPadre.classList.add("contenido-opcion");
                    
                    //IMAGEN
                    var img = document.createElement("img");
                    img.setAttribute("src","/img/bancos/<%=payment_admin.bank%>.png");

                    //DIV HIJO
                    var divHijo = document.createElement("div");
                    divHijo.classList.add("textos");

                    //H1
                    var h2 = document.createElement("h2");
                    h2.classList.add("titulo","tam-h2");
                    <%part1 = payment_admin.number_phone[0, 3]%>
                    <%part2 = payment_admin.number_phone[-4,4]%>
                    var content = document.createTextNode("<%=part1%>*****<%=part2%>");
                    
                    h2.appendChild(content);
                    divHijo.appendChild(h2);
                    divPadre.appendChild(img);
                    divPadre.appendChild(divHijo);
                    enlace.appendChild(divPadre);
                    selectBox.appendChild(enlace);
                <%end%>
            } 
        <%end%>         
    }

    function mostrarAccountDestinityAdmin(){
        country = "<%=current_user.country%>";
        switch (country){
            case "Argentina":
                <%if admin.banks.count > 0%>         
                    optionBanksAdmin(country);
                <%end%>    
                break;
            
            case "Brasil":
                <%if admin.bank_brasils.count > 0%>         
                    optionBanksBrasilAdmin(country);
                <%end%> 

                <%if admin.wallets.count > 0%>         
                    optionWalletsAdmin(country);
                <%end%> 
            
                <%if admin.wallet_with_users.count > 0%>         
                    optionWalletsAdminWithUser(country);
                <%end%>
                break;

            case "Chile":         
                <%if admin.banks.count > 0%>         
                    optionBanksAdmin(country);
                <%end%>    
                break;
            
            case "Colombia":         
                <%if admin.banks.count > 0%>         
                    optionBanksAdmin(country);
                <%end%>    

                <%if admin.digital_payments.count > 0%>         
                    optionDigitalPaymentsAdmin(country);
                <%end%>    
                break;

            case "Ecuador":         
                <%if admin.banks.count > 0%>         
                    optionBanksAdmin(country);
                <%end%>  
                break;

            case "España":         
                <%if admin.banks.count > 0%>         
                    optionBanksAdmin(country);
                <%end%>  
                break;

            case "Panama":         
                <%if admin.banks.count > 0%>         
                    optionBanksAdmin(country);
                <%end%>  
                break;

            case "Peru":         
                <%if admin.banks.count > 0%>         
                    optionBanksAdmin(country);
                <%end%>  
                break;

            case "USA":         
                <%if admin.wallets.count > 0%>         
                    optionWalletsAdmin(country);
                <%end%>  
                break;

            case "Venezuela":
                
                <%if admin.banks.count > 0%>         
                    optionBanksAdmin(country);
                <%end%> 
                
                <%if admin.digital_payments.count > 0%>         
                    optionMobilePaymentsAdmin(country);
                <%end%> 
                break;
            
            default:
                break;

        }

    }    
    mostrarAccountDestinityAdmin();

    function activarFuncionSelectBoxAccountDestinityAdmin(){
        contenidoSelectAccountAdminDestino = document.querySelector('#selectAccountAdminDestino .contenido-select');
        hiddenInputAccountAdminDestino = document.querySelector('#inputAccountAdminDestino');
        cajaMetodosPago = document.querySelector('#metodosPago');

        document.querySelectorAll('#opcionesAccountAdminDestino > .opcion').forEach((opcion) => {
            opcion.addEventListener('click', (e) => {
                e.preventDefault();
                contenidoSelectAccountAdminDestino.innerHTML = e.currentTarget.innerHTML;
                selectAccountAdminDestino.classList.remove('active');
                opcionesAccountAdminDestino.classList.remove('active');
                hiddenInputAccountAdminDestino.value = e.currentTarget.id;
                document.getElementById("detail-cuenta-otacar").innerHTML = e.currentTarget.querySelector('.titulo').innerText;
                mostrarMetodosPago(hiddenInputAccountAdminDestino.value);
                cajaMetodosPago.classList.remove('d-none');
            });
        });

        selectAccountAdminDestino.addEventListener('click', () => {
            selectAccountAdminDestino.classList.toggle('active');
            opcionesAccountAdminDestino.classList.toggle('active');  

            //INACTIVAR SELECT BOX PAIS DESTINO
            selectPaisDestino.classList.remove('active');
            opcionesPaisDestino.classList.remove('active'); 

            //INACTIVAR SELECT BOX ACCOUNT USER
            selectAccountUserDestino.classList.remove('active');
            opcionesAccountUserDestino.classList.remove('active');

            //INACTIVAR SELECT BOX METODOS DE PAGO
            selectMetodoPago.classList.remove('active'); 
            opcionesMetodoPago.classList.remove('active'); 
        }); 
    }
    activarFuncionSelectBoxAccountDestinityAdmin();

    //FUNCIONES METODOS DE PAGO

    function activarFuncionSelectBoxMetodosPago(){
        selectMetodoPago.classList.toggle('active');
        opcionesMetodoPago.classList.toggle('active');

        //INACTIVAR SELECT BOX PAIS DESTINO
        selectPaisDestino.classList.remove('active');
        opcionesPaisDestino.classList.remove('active');

        //INACTIVAR SELECT BOX ACCOUNT USER
        selectAccountUserDestino.classList.remove('active');
        opcionesAccountUserDestino.classList.remove('active');

        //INACTIVAR SELECT BOX ACCOUNT ADMIN
        selectAccountAdminDestino.classList.remove('active');
        opcionesAccountAdminDestino.classList.remove('active');
    }

    function activarEnlaceMetodoP(e){
        e.preventDefault();
        selectMetodoPago = document.querySelector('#selectMetodoPago');
        metodoPago = document.querySelector('#metodoPago');
        opcionesMetodoPago = document.querySelector('#opcionesMetodoPago');
        contenidoSelectMetodoPago = document.querySelector('#selectMetodoPago .contenido-select');
        hiddenInputMetodoPago = document.querySelector('#inputMetodoPago');
        cajaMontoEnvio = document.querySelector('#montoEnvio');

        contenidoSelectMetodoPago.innerHTML = e.currentTarget.innerHTML;
        selectMetodoPago.classList.toggle('active');
        opcionesMetodoPago.classList.toggle('active');
        hiddenInputMetodoPago.value = e.currentTarget.querySelector('.titulo').innerText;
        //Escribir dato en los detalles del Modal
        document.getElementById("detail-forma-pago").innerHTML =  e.currentTarget.querySelector('.titulo').innerText;
        habilitarMonto();
        cajaMontoEnvio.classList.remove("d-none");

    }

    function crearElementosMetodoPago(metodos){
        var selectBox = document.getElementById("opcionesMetodoPago");

        campoMetodoPago = document.getElementById("contenidoSelectMetodoPago");
        campoMetodoPago.innerHTML = "<h2 class='titulo' id='tituloMetodoPago'>Elige una opcion</h2>"

        options = selectBox.childNodes;
        if (options.length > 0){
            limit = options.length;
            for (j=0; j < limit; j++){
                selectBox.removeChild(options[0]);   
            }
        }

        for(i=0; i<metodos.length; i++){
            
            //ENLACE
            var enlace = document.createElement("a");
            enlace.setAttribute("href","#");
            enlace.setAttribute("onclick","activarEnlaceMetodoP(event)");
            enlace.classList.add("opcion");

            //DIV PADRE
            var divPadre = document.createElement("div");
            divPadre.classList.add("contenido-opcion");
            
            //H2
            var h2 = document.createElement("h2");
            h2.classList.add("titulo");
            
            var content = document.createTextNode(metodos[i]);
            
            h2.appendChild(content);
            divPadre.appendChild(h2);
            enlace.appendChild(divPadre);

            selectBox.appendChild(enlace);
        } 
    }

    function mostrarMetodosPago(account){
        accountType = account.split("-");
        switch (accountType[0]){
            case "banks":        
                metodos = ["Transferencia", "Deposito"];
                crearElementosMetodoPago(metodos);
                break;
            
            case "bank_brasils":   
                metodos = ["Transferencia", "Deposito", "Deposito Por Cajero Automatico"];
                crearElementosMetodoPago(metodos); 
                break;
            
            case "caixa":

                metodos = ["Transferencia", "Deposito", "Deposito Por Cajero Automatico", "Deposito Por Loterica"];
                crearElementosMetodoPago(metodos); 
                break;

            case "mobile_payments":         
                metodos = ["Pago Movil"];
                crearElementosMetodoPago(metodos); 
                break;
            
            default:
                metodos = ["Envio"];
                crearElementosMetodoPago(metodos); 
                break;
        }
    }   

    //FUNCIONES DEl INPUT MONTO
    function formatearNumeros(numero){
        valor = numero.replace(/\D/g, "");
        valor = valor.replace(/([0-9])([0-9]{2})$/, "$1.$2");
        valor = valor.replace(/\B(?=(\d{3})+(?!\d)\.?)/g, "");
        numeroF = parseFloat(valor);
        return numeroF;
    }

    function formatTasa(numero) {
        //Formatear Tasa
        re = /\./g;
        valor = numero.replace(re, '')
        re = /,/i;
        valor = valor.replace(re, '.')
        valor = parseFloat(valor);
        return valor
    }

    function formatearString(numero){
        valor = numero.toString()
        valor = valor.replace(/\D/g, "");
        valor = valor.replace(/([0-9])([0-9]{2})$/, "$1,$2");
        valor = valor.replace(/\B(?=(\d{3})+(?!\d)\.?)/g, ".");

        if (valor.length === 1){
            valor = "0,0".concat(valor);
        }else if(valor.length === 2){
            
            valor = "0,".concat(valor);
             
        }else if(valor.length === 4){

        }
        else if(valor.length === 5){
            if (valor[0] === "0") {
                valor = valor.slice(1);
            }
            
        }else{           
            limit = valor.length 
            for (i=0; i < limit; i++){
                if(valor[0] === "0" || valor[0] === "."){
                    valor = valor.slice(1);
                }else{
                    break;
                }  
            }   
        }  
        return valor;
    }
    
    function mostrarTasa(paisDestino,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD){
        let imgPaisD = document.getElementById("paisDestino"),
            tasa = document.getElementById("tasa"),
            tasaOf = document.getElementById("tasaOf"),
            tasaOf2 = document.getElementById("tasaOf2"),
            montoMin = document.getElementById("montoMin"),
            inputMonto = document.getElementById("validationMonto");
        
        imgPaisD.setAttribute("src","/img/paises/"+paisDestino+".svg");
        imgPaisD.setAttribute("title",paisDestino);
        imgPaisD.setAttribute("alt",paisDestino);
        
        tasa.innerHTML = montoTasa + " " + monedaPaisD;
        tasa_minima = formatTasa(montoTasa)
        tasaOf.innerHTML = "";
        tasaOf2.innerHTML = "";
        if ("<%=rate.monto_oferta%>" != "0,00" && montoTasaOferta != "0,00"){
            tasaOf.innerHTML = "<br><br>Más de <%=rate.monto_oferta%> <%=rate.moneda%><br>"
            monto_oferta = formatearNumeros("<%=rate.monto_oferta%>")
            tasaOf2.innerHTML = montoTasaOferta + " " + monedaPaisD;
            tasa_oferta = formatTasa(montoTasaOferta)
        }

        inputMonto.setAttribute("oninput","monto(this),validarMonto(this,'"+montoMinimo+"')");
        montoMin.innerHTML = montoMinimo;

    }

    function habilitarMonto() {

        paisDestino = document.getElementById("inputPais");
            
        switch(paisDestino.value){
            case "Argentina":
                montoTasa = "<%=rate.rate_argentina%>";
                montoTasaOferta = "<%=rate.rate_argentina_min%>";
                montoMinimo = "<%=rate.monto_min_argentina%>";
                monedaPaisD = "$"
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "Brasil":
                montoTasa = "<%=rate.rate_brasil%>";
                montoTasaOferta = "<%=rate.rate_brasil_min%>";
                montoMinimo = "<%=rate.monto_min_brasil%>";
                monedaPaisD = "R$"
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "Chile":
                montoTasa = "<%=rate.rate_chile%>";
                montoTasaOferta = "<%=rate.rate_chile_min%>";
                montoMinimo = "<%=rate.monto_min_chile%>";
                monedaPaisD = "CLP";
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "Colombia":
                montoTasa = "<%=rate.rate_colombia%>";
                montoTasaOferta = "<%=rate.rate_colombia_min%>";
                montoMinimo = "<%=rate.monto_min_colombia%>";
                monedaPaisD = "$";
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "Ecuador":
                montoTasa = "<%=rate.rate_ecuador%>";
                montoTasaOferta = "<%=rate.rate_ecuador_min%>";
                montoMinimo = "<%=rate.monto_min_ecuador%>";
                monedaPaisD = "$";
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "España":
                montoTasa = "<%=rate.rate_españa%>";
                montoTasaOferta = "<%=rate.rate_españa_min%>";
                montoMinimo = "<%=rate.monto_min_españa%>";
                monedaPaisD = "€";
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "Panama":
                montoTasa = "<%=rate.rate_panama%>";
                montoTasaOferta = "<%=rate.rate_panama_min%>";
                montoMinimo = "<%=rate.monto_min_panama%>";
                monedaPaisD = "$";
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "Peru":
                montoTasa = "<%=rate.rate_peru%>";
                montoTasaOferta = "<%=rate.rate_peru_min%>";
                montoMinimo = "<%=rate.monto_min_peru%>";
                monedaPaisD = "/S";
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "USA":
                montoTasa = "<%=rate.rate_usa%>";
                montoTasaOferta = "<%=rate.rate_usa_min%>";
                montoMinimo = "<%=rate.monto_min_usa%>";
                monedaPaisD = "$";
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;

            case "Venezuela":
                montoTasa = "<%=rate.rate_venezuela%>";
                montoTasaOferta = "<%=rate.rate_venezuela_min%>";
                montoMinimo = "<%=rate.monto_min_venezuela%>";
                monedaPaisD = "Bs";
                mostrarTasa(paisDestino.value,montoTasa,montoTasaOferta,montoMinimo,monedaPaisD);
                break;
        
            default:
                break;

        } 

        let montoEnvio = document.getElementById("montoEnvio");
        montoEnvio.classList.remove("d-none");
        
    }

    //FUNCION DEL INPUT MONTO
    
    function validarMonto(input,montoMin){
        boton = document.getElementById("btnEnviarDinero");

        montoSend = input.value.replace(/\D/g, "");                
        montoSend = montoSend.replace(/([0-9])([0-9]{2})$/, '$1.$2');
        montoSend = parseFloat(montoSend);

        montoMinx = montoMin.replace(/\D/g, "");                
        montoMinx = montoMinx.replace(/([0-9])([0-9]{2})$/, '$1.$2');
        montoMinx = parseFloat(montoMinx);

        if (montoSend < montoMinx){
            input.classList.remove("is-valid");
            input.classList.add("is-invalid");
            boton.classList.add("d-none");
        }else{
            input.classList.remove("is-invalid");
            input.classList.add("is-valid");
            boton.classList.remove("d-none");
        }
    }

    //FUNCION DATOS DE LOS DETALLES EN EL MODAL
    tasa_minima = 0.0
    tasa_oferta = 0.0
    monto_oferta = 0.0
    monedaPaisD = ""
    function detail_transaction(){
        //TASA Y MONTO A RECIBIR
        
        spanTasa = document.getElementById("detail-tasa");
        spanMontoToRecibir = document.getElementById("detail-monto-a-recibir")

        input_monto_envio = document.getElementById("validationMonto").value
        monto_envio = formatearNumeros(input_monto_envio)
        
        if (monto_oferta > 0){
            if (monto_envio >= monto_oferta){
                spanTasa.innerHTML = document.getElementById("tasaOf2").innerText
                monto_a_recibir = monto_envio * tasa_oferta
                spanMontoToRecibir.innerHTML = formatearString(monto_a_recibir.toFixed(2)) + " " + monedaPaisD
            }else{
                spanTasa.innerHTML = document.getElementById("tasa").innerText
                monto_a_recibir = monto_envio * tasa_minima
                spanMontoToRecibir.innerHTML = formatearString(monto_a_recibir.toFixed(2)) + " " + monedaPaisD
            }
        }else{
            spanTasa.innerHTML = document.getElementById("tasa").innerText
            monto_a_recibir = monto_envio * tasa_minima
            spanMontoToRecibir.innerHTML = formatearString(monto_a_recibir.toFixed(2)) + " " + monedaPaisD
        }

        //MONTO ENVIO
        document.getElementById("detail-monto-envio").innerHTML = input_monto_envio + " <%=rate.moneda%>"

        //COMISION
        
        account_usuario = document.getElementById("inputAccountUserDestino").value
        account_usuario2 = document.getElementById("inputAccountUserDestino2").value
        
        if(account_usuario2 === ""){
            method = account_usuario.split("-")
            if (method[0] === "mobile_payments"){
                banks = ["0102","0116","0134","0105"]
                if (banks.indexOf(document.getElementById("img-bank-payment").alt) != -1 ){
                    document.getElementById("list-comision").classList.remove("d-none")
                    document.getElementById("list-comision-2").classList.remove("d-none")
                    
                    //ESCRIBIR COMISIÓN
                    comision = monto_a_recibir - (monto_a_recibir / 1.003)
                    document.getElementById("detail-comision").innerHTML = formatearString(comision.toFixed(2)) + " " + monedaPaisD
                    //ESCRIBIR TOTAL A PAGAR
                    total_a_recibir = monto_a_recibir - comision
                    document.getElementById("detail-monto-total").innerHTML = formatearString(total_a_recibir.toFixed(2)) + " " + monedaPaisD
                }else{
                    document.getElementById("list-comision").classList.add("d-none")
                    document.getElementById("list-comision-2").classList.add("d-none")
                }
            }else{
                document.getElementById("list-comision").classList.add("d-none")
                document.getElementById("list-comision-2").classList.add("d-none")
            }
        }else{
            document.getElementById("list-comision").classList.add("d-none")
            document.getElementById("list-comision-2").classList.add("d-none")
        }
    }

    //FORMATEAR MONTOS PARA GUARDARLOS EN LA BASE DE DATOS
    function formatearMonto(){
        input_monto_envio = document.getElementById("validationMonto")
        monto_envio = formatearNumeros(input_monto_envio.value)
        input_monto_envio.value = monto_envio

        if(document.getElementById("inputPais").value === "Venezuela"){
            if (contenedorAccountUser2.classList.value != "contenedor d-none" ){
                if (document.getElementById("inputAccountUserDestino2").value != ""){
                    document.getElementById("inputAccountUserDestino").value = document.getElementById("inputAccountUserDestino").value + "," + document.getElementById("inputAccountUserDestino2").value
                }
            }
            if (contenedorAccountUser3.classList.value != "contenedor d-none" ){
                if (document.getElementById("inputAccountUserDestino3").value != ""){
                    document.getElementById("inputAccountUserDestino").value = document.getElementById("inputAccountUserDestino").value + "," + document.getElementById("inputAccountUserDestino3").value
                }
            }
        }
    }
    
    <%= render 'partials/script-preloader'%>
</script>